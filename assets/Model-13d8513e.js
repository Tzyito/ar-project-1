import{E as Pt,V as G,b as ee,T as te,Q as ge,c as Xe,d as v,e as ot,f as pe,g as Ot,h as Me,i as rt,L as _t,j as Se,F as it,C as Z,k as Ct,l as Dt,D as at,M as ie,s as ae,m as Q,n as ce,I as Ft,O as ct,o as me,p as Ht,q as kt,r as lt,t as ut,R as Ne,u as Ut,v as ye,w as Bt,x as ft,y as dt,z as Gt,A as vt,a as ht,G as jt,H as Kt,J as zt,K as Xt,N as be,P as pt,U as Vt,X as Yt,Y as Wt,Z as mt,_ as qt,$ as Zt,a0 as gt,a1 as Jt,a2 as Qt,a3 as $t,a4 as en,a5 as tn,a6 as nn,a7 as sn,a8 as on,a9 as Ve,aa as rn,ab as Ye,ac as an,ad as cn,ae as ln,af as un,S as fn,ag as dn,ah as se,ai as hn,aj as pn,W as mn,ak as gn,al as Tn,am as An}from"./three.module-37a96f70.js";import{u as En,_ as yn}from"./index.vue_vue_type_script_setup_true_lang-23726459.js";import{d as bn,g as Rn,h as xn,o as We,c as wn,i as Tt,a as Ln,j as Mn}from"./index-33abb37a.js";const H=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];for(let h=0;h<256;h++)H[256+h]=H[h];function Re(h){return h*h*h*(h*(h*6-15)+10)}function J(h,s,t){return s+h*(t-s)}function Y(h,s,t,e){const n=h&15,o=n<8?s:t,r=n<4?t:n==12||n==14?s:e;return(n&1?-o:o)+(n&2?-r:r)}class Sn{noise(s,t,e){const n=Math.floor(s),o=Math.floor(t),r=Math.floor(e),a=n&255,i=o&255,l=r&255;s-=n,t-=o,e-=r;const f=s-1,c=t-1,d=e-1,p=Re(s),A=Re(t),b=Re(e),T=H[a]+i,m=H[T]+l,w=H[T+1]+l,R=H[a+1]+i,E=H[R]+l,g=H[R+1]+l;return J(b,J(A,J(p,Y(H[m],s,t,e),Y(H[E],f,t,e)),J(p,Y(H[w],s,c,e),Y(H[g],f,c,e))),J(A,J(p,Y(H[m+1],s,t,d),Y(H[E+1],f,t,d)),J(p,Y(H[w+1],s,c,d),Y(H[g+1],f,c,d))))}}const qe={type:"change"},xe={type:"start"},Ze={type:"end"};class Nn extends Pt{constructor(s,t){super(),this.object=s,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new G,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ee.ROTATE,MIDDLE:ee.DOLLY,RIGHT:ee.PAN},this.touches={ONE:te.ROTATE,TWO:te.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(u){u.addEventListener("keydown",Ge),this._domElementKeyEvents=u},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(qe),e.update(),o=n.NONE},this.update=function(){const u=new G,y=new ge().setFromUnitVectors(s.up,new G(0,1,0)),C=y.clone().invert(),D=new G,z=new ge,$=2*Math.PI;return function(){const ze=e.object.position;u.copy(ze).sub(e.target),u.applyQuaternion(y),a.setFromVector3(u),e.autoRotate&&o===n.NONE&&M(S()),e.enableDamping?(a.theta+=i.theta*e.dampingFactor,a.phi+=i.phi*e.dampingFactor):(a.theta+=i.theta,a.phi+=i.phi);let X=e.minAzimuthAngle,V=e.maxAzimuthAngle;return isFinite(X)&&isFinite(V)&&(X<-Math.PI?X+=$:X>Math.PI&&(X-=$),V<-Math.PI?V+=$:V>Math.PI&&(V-=$),X<=V?a.theta=Math.max(X,Math.min(V,a.theta)):a.theta=a.theta>(X+V)/2?Math.max(X,a.theta):Math.min(V,a.theta)),a.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=l,a.radius=Math.max(e.minDistance,Math.min(e.maxDistance,a.radius)),e.enableDamping===!0?e.target.addScaledVector(f,e.dampingFactor):e.target.add(f),u.setFromSpherical(a),u.applyQuaternion(C),ze.copy(e.target).add(u),e.object.lookAt(e.target),e.enableDamping===!0?(i.theta*=1-e.dampingFactor,i.phi*=1-e.dampingFactor,f.multiplyScalar(1-e.dampingFactor)):(i.set(0,0,0),f.set(0,0,0)),l=1,c||D.distanceToSquared(e.object.position)>r||8*(1-z.dot(e.object.quaternion))>r?(e.dispatchEvent(qe),D.copy(e.object.position),z.copy(e.object.quaternion),c=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",ve),e.domElement.removeEventListener("pointerdown",ke),e.domElement.removeEventListener("pointercancel",Ue),e.domElement.removeEventListener("wheel",Be),e.domElement.removeEventListener("pointermove",Te),e.domElement.removeEventListener("pointerup",Ae),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",Ge)};const e=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=n.NONE;const r=1e-6,a=new Xe,i=new Xe;let l=1;const f=new G;let c=!1;const d=new v,p=new v,A=new v,b=new v,T=new v,m=new v,w=new v,R=new v,E=new v,g=[],L={};function S(){return 2*Math.PI/60/60*e.autoRotateSpeed}function N(){return Math.pow(.95,e.zoomSpeed)}function M(u){i.theta-=u}function O(u){i.phi-=u}const I=function(){const u=new G;return function(C,D){u.setFromMatrixColumn(D,0),u.multiplyScalar(-C),f.add(u)}}(),_=function(){const u=new G;return function(C,D){e.screenSpacePanning===!0?u.setFromMatrixColumn(D,1):(u.setFromMatrixColumn(D,0),u.crossVectors(e.object.up,u)),u.multiplyScalar(C),f.add(u)}}(),P=function(){const u=new G;return function(C,D){const z=e.domElement;if(e.object.isPerspectiveCamera){const $=e.object.position;u.copy($).sub(e.target);let he=u.length();he*=Math.tan(e.object.fov/2*Math.PI/180),I(2*C*he/z.clientHeight,e.object.matrix),_(2*D*he/z.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(I(C*(e.object.right-e.object.left)/e.object.zoom/z.clientWidth,e.object.matrix),_(D*(e.object.top-e.object.bottom)/e.object.zoom/z.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function j(u){e.object.isPerspectiveCamera?l/=u:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*u)),e.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function k(u){e.object.isPerspectiveCamera?l*=u:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/u)),e.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function F(u){d.set(u.clientX,u.clientY)}function U(u){w.set(u.clientX,u.clientY)}function B(u){b.set(u.clientX,u.clientY)}function le(u){p.set(u.clientX,u.clientY),A.subVectors(p,d).multiplyScalar(e.rotateSpeed);const y=e.domElement;M(2*Math.PI*A.x/y.clientHeight),O(2*Math.PI*A.y/y.clientHeight),d.copy(p),e.update()}function ue(u){R.set(u.clientX,u.clientY),E.subVectors(R,w),E.y>0?j(N()):E.y<0&&k(N()),w.copy(R),e.update()}function fe(u){T.set(u.clientX,u.clientY),m.subVectors(T,b).multiplyScalar(e.panSpeed),P(m.x,m.y),b.copy(T),e.update()}function de(u){u.deltaY<0?k(N()):u.deltaY>0&&j(N()),e.update()}function yt(u){let y=!1;switch(u.code){case e.keys.UP:u.ctrlKey||u.metaKey||u.shiftKey?O(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):P(0,e.keyPanSpeed),y=!0;break;case e.keys.BOTTOM:u.ctrlKey||u.metaKey||u.shiftKey?O(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):P(0,-e.keyPanSpeed),y=!0;break;case e.keys.LEFT:u.ctrlKey||u.metaKey||u.shiftKey?M(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):P(e.keyPanSpeed,0),y=!0;break;case e.keys.RIGHT:u.ctrlKey||u.metaKey||u.shiftKey?M(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):P(-e.keyPanSpeed,0),y=!0;break}y&&(u.preventDefault(),e.update())}function Oe(){if(g.length===1)d.set(g[0].pageX,g[0].pageY);else{const u=.5*(g[0].pageX+g[1].pageX),y=.5*(g[0].pageY+g[1].pageY);d.set(u,y)}}function _e(){if(g.length===1)b.set(g[0].pageX,g[0].pageY);else{const u=.5*(g[0].pageX+g[1].pageX),y=.5*(g[0].pageY+g[1].pageY);b.set(u,y)}}function Ce(){const u=g[0].pageX-g[1].pageX,y=g[0].pageY-g[1].pageY,C=Math.sqrt(u*u+y*y);w.set(0,C)}function bt(){e.enableZoom&&Ce(),e.enablePan&&_e()}function Rt(){e.enableZoom&&Ce(),e.enableRotate&&Oe()}function De(u){if(g.length==1)p.set(u.pageX,u.pageY);else{const C=Ee(u),D=.5*(u.pageX+C.x),z=.5*(u.pageY+C.y);p.set(D,z)}A.subVectors(p,d).multiplyScalar(e.rotateSpeed);const y=e.domElement;M(2*Math.PI*A.x/y.clientHeight),O(2*Math.PI*A.y/y.clientHeight),d.copy(p)}function Fe(u){if(g.length===1)T.set(u.pageX,u.pageY);else{const y=Ee(u),C=.5*(u.pageX+y.x),D=.5*(u.pageY+y.y);T.set(C,D)}m.subVectors(T,b).multiplyScalar(e.panSpeed),P(m.x,m.y),b.copy(T)}function He(u){const y=Ee(u),C=u.pageX-y.x,D=u.pageY-y.y,z=Math.sqrt(C*C+D*D);R.set(0,z),E.set(0,Math.pow(R.y/w.y,e.zoomSpeed)),j(E.y),w.copy(R)}function xt(u){e.enableZoom&&He(u),e.enablePan&&Fe(u)}function wt(u){e.enableZoom&&He(u),e.enableRotate&&De(u)}function ke(u){e.enabled!==!1&&(g.length===0&&(e.domElement.setPointerCapture(u.pointerId),e.domElement.addEventListener("pointermove",Te),e.domElement.addEventListener("pointerup",Ae)),It(u),u.pointerType==="touch"?St(u):Lt(u))}function Te(u){e.enabled!==!1&&(u.pointerType==="touch"?Nt(u):Mt(u))}function Ae(u){je(u),g.length===0&&(e.domElement.releasePointerCapture(u.pointerId),e.domElement.removeEventListener("pointermove",Te),e.domElement.removeEventListener("pointerup",Ae)),e.dispatchEvent(Ze),o=n.NONE}function Ue(u){je(u)}function Lt(u){let y;switch(u.button){case 0:y=e.mouseButtons.LEFT;break;case 1:y=e.mouseButtons.MIDDLE;break;case 2:y=e.mouseButtons.RIGHT;break;default:y=-1}switch(y){case ee.DOLLY:if(e.enableZoom===!1)return;U(u),o=n.DOLLY;break;case ee.ROTATE:if(u.ctrlKey||u.metaKey||u.shiftKey){if(e.enablePan===!1)return;B(u),o=n.PAN}else{if(e.enableRotate===!1)return;F(u),o=n.ROTATE}break;case ee.PAN:if(u.ctrlKey||u.metaKey||u.shiftKey){if(e.enableRotate===!1)return;F(u),o=n.ROTATE}else{if(e.enablePan===!1)return;B(u),o=n.PAN}break;default:o=n.NONE}o!==n.NONE&&e.dispatchEvent(xe)}function Mt(u){switch(o){case n.ROTATE:if(e.enableRotate===!1)return;le(u);break;case n.DOLLY:if(e.enableZoom===!1)return;ue(u);break;case n.PAN:if(e.enablePan===!1)return;fe(u);break}}function Be(u){e.enabled===!1||e.enableZoom===!1||o!==n.NONE||(u.preventDefault(),e.dispatchEvent(xe),de(u),e.dispatchEvent(Ze))}function Ge(u){e.enabled===!1||e.enablePan===!1||yt(u)}function St(u){switch(Ke(u),g.length){case 1:switch(e.touches.ONE){case te.ROTATE:if(e.enableRotate===!1)return;Oe(),o=n.TOUCH_ROTATE;break;case te.PAN:if(e.enablePan===!1)return;_e(),o=n.TOUCH_PAN;break;default:o=n.NONE}break;case 2:switch(e.touches.TWO){case te.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;bt(),o=n.TOUCH_DOLLY_PAN;break;case te.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Rt(),o=n.TOUCH_DOLLY_ROTATE;break;default:o=n.NONE}break;default:o=n.NONE}o!==n.NONE&&e.dispatchEvent(xe)}function Nt(u){switch(Ke(u),o){case n.TOUCH_ROTATE:if(e.enableRotate===!1)return;De(u),e.update();break;case n.TOUCH_PAN:if(e.enablePan===!1)return;Fe(u),e.update();break;case n.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;xt(u),e.update();break;case n.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;wt(u),e.update();break;default:o=n.NONE}}function ve(u){e.enabled!==!1&&u.preventDefault()}function It(u){g.push(u)}function je(u){delete L[u.pointerId];for(let y=0;y<g.length;y++)if(g[y].pointerId==u.pointerId){g.splice(y,1);return}}function Ke(u){let y=L[u.pointerId];y===void 0&&(y=new v,L[u.pointerId]=y),y.set(u.pageX,u.pageY)}function Ee(u){const y=u.pointerId===g[0].pointerId?g[1]:g[0];return L[y.pointerId]}e.domElement.addEventListener("contextmenu",ve),e.domElement.addEventListener("pointerdown",ke),e.domElement.addEventListener("pointercancel",Ue),e.domElement.addEventListener("wheel",Be,{passive:!1}),this.update()}}function In(h,s=!1){const t=h[0].index!==null,e=new Set(Object.keys(h[0].attributes)),n=new Set(Object.keys(h[0].morphAttributes)),o={},r={},a=h[0].morphTargetsRelative,i=new ot;let l=0;for(let f=0;f<h.length;++f){const c=h[f];let d=0;if(t!==(c.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const p in c.attributes){if(!e.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;o[p]===void 0&&(o[p]=[]),o[p].push(c.attributes[p]),d++}if(d!==e.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(a!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const p in c.morphAttributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;r[p]===void 0&&(r[p]=[]),r[p].push(c.morphAttributes[p])}if(s){let p;if(t)p=c.index.count;else if(c.attributes.position!==void 0)p=c.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;i.addGroup(l,p,f),l+=p}}if(t){let f=0;const c=[];for(let d=0;d<h.length;++d){const p=h[d].index;for(let A=0;A<p.count;++A)c.push(p.getX(A)+f);f+=h[d].attributes.position.count}i.setIndex(c)}for(const f in o){const c=Je(o[f]);if(!c)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+f+" attribute."),null;i.setAttribute(f,c)}for(const f in r){const c=r[f][0].length;if(c===0)break;i.morphAttributes=i.morphAttributes||{},i.morphAttributes[f]=[];for(let d=0;d<c;++d){const p=[];for(let b=0;b<r[f].length;++b)p.push(r[f][b][d]);const A=Je(p);if(!A)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+f+" morphAttribute."),null;i.morphAttributes[f].push(A)}}return i}function Je(h){let s,t,e,n=0;for(let a=0;a<h.length;++a){const i=h[a];if(i.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(s===void 0&&(s=i.array.constructor),s!==i.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=i.itemSize),t!==i.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(e===void 0&&(e=i.normalized),e!==i.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=i.array.length}const o=new s(n);let r=0;for(let a=0;a<h.length;++a)o.set(h[a].array,r),r+=h[a].array.length;return new pe(o,t,e)}function Qe(h,s){if(s===Ot)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),h;if(s===Me||s===rt){let t=h.getIndex();if(t===null){const r=[],a=h.getAttribute("position");if(a!==void 0){for(let i=0;i<a.count;i++)r.push(i);h.setIndex(r),t=h.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),h}const e=t.count-2,n=[];if(s===Me)for(let r=1;r<=e;r++)n.push(t.getX(0)),n.push(t.getX(r)),n.push(t.getX(r+1));else for(let r=0;r<e;r++)r%2===0?(n.push(t.getX(r)),n.push(t.getX(r+1)),n.push(t.getX(r+2))):(n.push(t.getX(r+2)),n.push(t.getX(r+1)),n.push(t.getX(r)));n.length/3!==e&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=h.clone();return o.setIndex(n),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",s),h}class Pn extends _t{constructor(s){super(s),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Fn(t)}),this.register(function(t){return new jn(t)}),this.register(function(t){return new Kn(t)}),this.register(function(t){return new kn(t)}),this.register(function(t){return new Un(t)}),this.register(function(t){return new Bn(t)}),this.register(function(t){return new Gn(t)}),this.register(function(t){return new Dn(t)}),this.register(function(t){return new vn(t)}),this.register(function(t){return new Hn(t)}),this.register(function(t){return new _n(t)}),this.register(function(t){return new zn(t)}),this.register(function(t){return new Xn(t)})}load(s,t,e,n){const o=this;let r;this.resourcePath!==""?r=this.resourcePath:this.path!==""?r=this.path:r=Se.extractUrlBase(s),this.manager.itemStart(s);const a=function(l){n?n(l):console.error(l),o.manager.itemError(s),o.manager.itemEnd(s)},i=new it(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(s,function(l){try{o.parse(l,r,function(f){t(f),o.manager.itemEnd(s)},a)}catch(f){a(f)}},e,a)}setDRACOLoader(s){return this.dracoLoader=s,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(s){return this.ktx2Loader=s,this}setMeshoptDecoder(s){return this.meshoptDecoder=s,this}register(s){return this.pluginCallbacks.indexOf(s)===-1&&this.pluginCallbacks.push(s),this}unregister(s){return this.pluginCallbacks.indexOf(s)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(s),1),this}parse(s,t,e,n){let o;const r={},a={},i=new TextDecoder;if(typeof s=="string")o=JSON.parse(s);else if(s instanceof ArrayBuffer)if(i.decode(new Uint8Array(s,0,4))===At){try{r[x.KHR_BINARY_GLTF]=new Vn(s)}catch(c){n&&n(c);return}o=JSON.parse(r[x.KHR_BINARY_GLTF].content)}else o=JSON.parse(i.decode(s));else o=s;if(o.asset===void 0||o.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new rs(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const c=this.pluginCallbacks[f](l);a[c.name]=c,r[c.name]=!0}if(o.extensionsUsed)for(let f=0;f<o.extensionsUsed.length;++f){const c=o.extensionsUsed[f],d=o.extensionsRequired||[];switch(c){case x.KHR_MATERIALS_UNLIT:r[c]=new Cn;break;case x.KHR_DRACO_MESH_COMPRESSION:r[c]=new Yn(o,this.dracoLoader);break;case x.KHR_TEXTURE_TRANSFORM:r[c]=new Wn;break;case x.KHR_MESH_QUANTIZATION:r[c]=new qn;break;default:d.indexOf(c)>=0&&a[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}l.setExtensions(r),l.setPlugins(a),l.parse(e,n)}parseAsync(s,t){const e=this;return new Promise(function(n,o){e.parse(s,t,n,o)})}}function On(){let h={};return{get:function(s){return h[s]},add:function(s,t){h[s]=t},remove:function(s){delete h[s]},removeAll:function(){h={}}}}const x={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class _n{constructor(s){this.parser=s,this.name=x.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const s=this.parser,t=this.parser.json.nodes||[];for(let e=0,n=t.length;e<n;e++){const o=t[e];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&s._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(s){const t=this.parser,e="light:"+s;let n=t.cache.get(e);if(n)return n;const o=t.json,i=((o.extensions&&o.extensions[this.name]||{}).lights||[])[s];let l;const f=new Z(16777215);i.color!==void 0&&f.fromArray(i.color);const c=i.range!==void 0?i.range:0;switch(i.type){case"directional":l=new at(f),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Dt(f),l.distance=c;break;case"spot":l=new Ct(f),l.distance=c,i.spot=i.spot||{},i.spot.innerConeAngle=i.spot.innerConeAngle!==void 0?i.spot.innerConeAngle:0,i.spot.outerConeAngle=i.spot.outerConeAngle!==void 0?i.spot.outerConeAngle:Math.PI/4,l.angle=i.spot.outerConeAngle,l.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return l.position.set(0,0,0),l.decay=2,q(l,i),i.intensity!==void 0&&(l.intensity=i.intensity),l.name=t.createUniqueName(i.name||"light_"+s),n=Promise.resolve(l),t.cache.add(e,n),n}getDependency(s,t){if(s==="light")return this._loadLight(t)}createNodeAttachment(s){const t=this,e=this.parser,o=e.json.nodes[s],a=(o.extensions&&o.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(i){return e._getNodeRef(t.cache,a,i)})}}class Cn{constructor(){this.name=x.KHR_MATERIALS_UNLIT}getMaterialType(){return ie}extendParams(s,t,e){const n=[];s.color=new Z(1,1,1),s.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const r=o.baseColorFactor;s.color.fromArray(r),s.opacity=r[3]}o.baseColorTexture!==void 0&&n.push(e.assignTexture(s,"map",o.baseColorTexture,ae))}return Promise.all(n)}}class Dn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(s,t){const n=this.parser.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=n.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}}class Fn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_CLEARCOAT}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const e=this.parser,n=e.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=[],r=n.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&o.push(e.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&o.push(e.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(o.push(e.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new v(a,a)}return Promise.all(o)}}class Hn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_IRIDESCENCE}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const e=this.parser,n=e.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=[],r=n.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&o.push(e.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&o.push(e.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(o)}}class kn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_SHEEN}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const e=this.parser,n=e.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new Z(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=n.extensions[this.name];return r.sheenColorFactor!==void 0&&t.sheenColor.fromArray(r.sheenColorFactor),r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&o.push(e.assignTexture(t,"sheenColorMap",r.sheenColorTexture,ae)),r.sheenRoughnessTexture!==void 0&&o.push(e.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(o)}}class Un{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_TRANSMISSION}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const e=this.parser,n=e.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=[],r=n.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&o.push(e.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(o)}}class Bn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_VOLUME}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const e=this.parser,n=e.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=[],r=n.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&o.push(e.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return t.attenuationColor=new Z(a[0],a[1],a[2]),Promise.all(o)}}class Gn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_IOR}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const n=this.parser.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=n.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class vn{constructor(s){this.parser=s,this.name=x.KHR_MATERIALS_SPECULAR}getMaterialType(s){const e=this.parser.json.materials[s];return!e.extensions||!e.extensions[this.name]?null:Q}extendMaterialParams(s,t){const e=this.parser,n=e.json.materials[s];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const o=[],r=n.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&o.push(e.assignTexture(t,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return t.specularColor=new Z(a[0],a[1],a[2]),r.specularColorTexture!==void 0&&o.push(e.assignTexture(t,"specularColorMap",r.specularColorTexture,ae)),Promise.all(o)}}class jn{constructor(s){this.parser=s,this.name=x.KHR_TEXTURE_BASISU}loadTexture(s){const t=this.parser,e=t.json,n=e.textures[s];if(!n.extensions||!n.extensions[this.name])return null;const o=n.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(s,o.source,r)}}class Kn{constructor(s){this.parser=s,this.name=x.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(s){const t=this.name,e=this.parser,n=e.json,o=n.textures[s];if(!o.extensions||!o.extensions[t])return null;const r=o.extensions[t],a=n.images[r.source];let i=e.textureLoader;if(a.uri){const l=e.options.manager.getHandler(a.uri);l!==null&&(i=l)}return this.detectSupport().then(function(l){if(l)return e.loadTextureImage(s,r.source,i);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return e.loadTexture(s)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(s){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){s(t.height===1)}})),this.isSupported}}class zn{constructor(s){this.name=x.EXT_MESHOPT_COMPRESSION,this.parser=s}loadBufferView(s){const t=this.parser.json,e=t.bufferViews[s];if(e.extensions&&e.extensions[this.name]){const n=e.extensions[this.name],o=this.parser.getDependency("buffer",n.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(a){const i=n.byteOffset||0,l=n.byteLength||0,f=n.count,c=n.byteStride,d=new Uint8Array(a,i,l);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(f,c,d,n.mode,n.filter).then(function(p){return p.buffer}):r.ready.then(function(){const p=new ArrayBuffer(f*c);return r.decodeGltfBuffer(new Uint8Array(p),f,c,d,n.mode,n.filter),p})})}else return null}}class Xn{constructor(s){this.name=x.EXT_MESH_GPU_INSTANCING,this.parser=s}createNodeMesh(s){const t=this.parser.json,e=t.nodes[s];if(!e.extensions||!e.extensions[this.name]||e.mesh===void 0)return null;const n=t.meshes[e.mesh];for(const l of n.primitives)if(l.mode!==K.TRIANGLES&&l.mode!==K.TRIANGLE_STRIP&&l.mode!==K.TRIANGLE_FAN&&l.mode!==void 0)return null;const r=e.extensions[this.name].attributes,a=[],i={};for(const l in r)a.push(this.parser.getDependency("accessor",r[l]).then(f=>(i[l]=f,i[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(s)),Promise.all(a).then(l=>{const f=l.pop(),c=f.isGroup?f.children:[f],d=l[0].count,p=[];for(const A of c){const b=new ce,T=new G,m=new ge,w=new G(1,1,1),R=new Ft(A.geometry,A.material,d);for(let E=0;E<d;E++)i.TRANSLATION&&T.fromBufferAttribute(i.TRANSLATION,E),i.ROTATION&&m.fromBufferAttribute(i.ROTATION,E),i.SCALE&&w.fromBufferAttribute(i.SCALE,E),R.setMatrixAt(E,b.compose(T,m,w));for(const E in i)E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&A.geometry.setAttribute(E,i[E]);ct.prototype.copy.call(R,A),R.frustumCulled=!1,this.parser.assignFinalMaterial(R),p.push(R)}return f.isGroup?(f.clear(),f.add(...p),f):p[0]}))}}const At="glTF",oe=12,$e={JSON:1313821514,BIN:5130562};class Vn{constructor(s){this.name=x.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(s,0,oe),e=new TextDecoder;if(this.header={magic:e.decode(new Uint8Array(s.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==At)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-oe,o=new DataView(s,oe);let r=0;for(;r<n;){const a=o.getUint32(r,!0);r+=4;const i=o.getUint32(r,!0);if(r+=4,i===$e.JSON){const l=new Uint8Array(s,oe+r,a);this.content=e.decode(l)}else if(i===$e.BIN){const l=oe+r;this.body=s.slice(l,l+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Yn{constructor(s,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=x.KHR_DRACO_MESH_COMPRESSION,this.json=s,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(s,t){const e=this.json,n=this.dracoLoader,o=s.extensions[this.name].bufferView,r=s.extensions[this.name].attributes,a={},i={},l={};for(const f in r){const c=Ie[f]||f.toLowerCase();a[c]=r[f]}for(const f in s.attributes){const c=Ie[f]||f.toLowerCase();if(r[f]!==void 0){const d=e.accessors[s.attributes[f]],p=ne[d.componentType];l[c]=p.name,i[c]=d.normalized===!0}}return t.getDependency("bufferView",o).then(function(f){return new Promise(function(c){n.decodeDracoFile(f,function(d){for(const p in d.attributes){const A=d.attributes[p],b=i[p];b!==void 0&&(A.normalized=b)}c(d)},a,l)})})}}class Wn{constructor(){this.name=x.KHR_TEXTURE_TRANSFORM}extendTexture(s,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(s=s.clone(),t.offset!==void 0&&s.offset.fromArray(t.offset),t.rotation!==void 0&&(s.rotation=t.rotation),t.scale!==void 0&&s.repeat.fromArray(t.scale),s.needsUpdate=!0),s}}class qn{constructor(){this.name=x.KHR_MESH_QUANTIZATION}}class Et extends un{constructor(s,t,e,n){super(s,t,e,n)}copySampleValue_(s){const t=this.resultBuffer,e=this.sampleValues,n=this.valueSize,o=s*n*3+n;for(let r=0;r!==n;r++)t[r]=e[o+r];return t}interpolate_(s,t,e,n){const o=this.resultBuffer,r=this.sampleValues,a=this.valueSize,i=a*2,l=a*3,f=n-t,c=(e-t)/f,d=c*c,p=d*c,A=s*l,b=A-l,T=-2*p+3*d,m=p-d,w=1-T,R=m-d+c;for(let E=0;E!==a;E++){const g=r[b+E+a],L=r[b+E+i]*f,S=r[A+E+a],N=r[A+E]*f;o[E]=w*g+R*L+T*S+m*N}return o}}const Zn=new ge;class Jn extends Et{interpolate_(s,t,e,n){const o=super.interpolate_(s,t,e,n);return Zn.fromArray(o).normalize().toArray(o),o}}const K={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ne={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},et={9728:gt,9729:lt,9984:Jt,9985:Qt,9986:$t,9987:ut},tt={33071:en,33648:tn,10497:Ne},we={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ie={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},W={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Qn={CUBICSPLINE:void 0,LINEAR:mt,STEP:nn},Le={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function $n(h){return h.DefaultMaterial===void 0&&(h.DefaultMaterial=new ft({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:sn})),h.DefaultMaterial}function re(h,s,t){for(const e in t.extensions)h[e]===void 0&&(s.userData.gltfExtensions=s.userData.gltfExtensions||{},s.userData.gltfExtensions[e]=t.extensions[e])}function q(h,s){s.extras!==void 0&&(typeof s.extras=="object"?Object.assign(h.userData,s.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+s.extras))}function es(h,s,t){let e=!1,n=!1,o=!1;for(let l=0,f=s.length;l<f;l++){const c=s[l];if(c.POSITION!==void 0&&(e=!0),c.NORMAL!==void 0&&(n=!0),c.COLOR_0!==void 0&&(o=!0),e&&n&&o)break}if(!e&&!n&&!o)return Promise.resolve(h);const r=[],a=[],i=[];for(let l=0,f=s.length;l<f;l++){const c=s[l];if(e){const d=c.POSITION!==void 0?t.getDependency("accessor",c.POSITION):h.attributes.position;r.push(d)}if(n){const d=c.NORMAL!==void 0?t.getDependency("accessor",c.NORMAL):h.attributes.normal;a.push(d)}if(o){const d=c.COLOR_0!==void 0?t.getDependency("accessor",c.COLOR_0):h.attributes.color;i.push(d)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(i)]).then(function(l){const f=l[0],c=l[1],d=l[2];return e&&(h.morphAttributes.position=f),n&&(h.morphAttributes.normal=c),o&&(h.morphAttributes.color=d),h.morphTargetsRelative=!0,h})}function ts(h,s){if(h.updateMorphTargets(),s.weights!==void 0)for(let t=0,e=s.weights.length;t<e;t++)h.morphTargetInfluences[t]=s.weights[t];if(s.extras&&Array.isArray(s.extras.targetNames)){const t=s.extras.targetNames;if(h.morphTargetInfluences.length===t.length){h.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++)h.morphTargetDictionary[t[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ns(h){const s=h.extensions&&h.extensions[x.KHR_DRACO_MESH_COMPRESSION];let t;return s?t="draco:"+s.bufferView+":"+s.indices+":"+nt(s.attributes):t=h.indices+":"+nt(h.attributes)+":"+h.mode,t}function nt(h){let s="";const t=Object.keys(h).sort();for(let e=0,n=t.length;e<n;e++)s+=t[e]+":"+h[t[e]]+";";return s}function Pe(h){switch(h){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function ss(h){return h.search(/\.jpe?g($|\?)/i)>0||h.search(/^data\:image\/jpeg/)===0?"image/jpeg":h.search(/\.webp($|\?)/i)>0||h.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const os=new ce;class rs{constructor(s={},t={}){this.json=s,this.extensions={},this.plugins={},this.options=t,this.cache=new On,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let e=!1,n=!1,o=-1;typeof navigator<"u"&&(e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,o=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||e||n&&o<98?this.textureLoader=new me(this.options.manager):this.textureLoader=new Ht(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new it(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(s){this.extensions=s}setPlugins(s){this.plugins=s}parse(s,t){const e=this,n=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([e.getDependencies("scene"),e.getDependencies("animation"),e.getDependencies("camera")])}).then(function(r){const a={scene:r[0][n.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:n.asset,parser:e,userData:{}};re(o,a,n),q(a,n),Promise.all(e._invokeAll(function(i){return i.afterRoot&&i.afterRoot(a)})).then(function(){s(a)})}).catch(t)}_markDefs(){const s=this.json.nodes||[],t=this.json.skins||[],e=this.json.meshes||[];for(let n=0,o=t.length;n<o;n++){const r=t[n].joints;for(let a=0,i=r.length;a<i;a++)s[r[a]].isBone=!0}for(let n=0,o=s.length;n<o;n++){const r=s[n];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(e[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(s,t){t!==void 0&&(s.refs[t]===void 0&&(s.refs[t]=s.uses[t]=0),s.refs[t]++)}_getNodeRef(s,t,e){if(s.refs[t]<=1)return e;const n=e.clone(),o=(r,a)=>{const i=this.associations.get(r);i!=null&&this.associations.set(a,i);for(const[l,f]of r.children.entries())o(f,a.children[l])};return o(e,n),n.name+="_instance_"+s.uses[t]++,n}_invokeOne(s){const t=Object.values(this.plugins);t.push(this);for(let e=0;e<t.length;e++){const n=s(t[e]);if(n)return n}return null}_invokeAll(s){const t=Object.values(this.plugins);t.unshift(this);const e=[];for(let n=0;n<t.length;n++){const o=s(t[n]);o&&e.push(o)}return e}getDependency(s,t){const e=s+":"+t;let n=this.cache.get(e);if(!n){switch(s){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":n=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(s,t)}),!n)throw new Error("Unknown type: "+s);break}this.cache.add(e,n)}return n}getDependencies(s){let t=this.cache.get(s);if(!t){const e=this,n=this.json[s+(s==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(o,r){return e.getDependency(s,r)})),this.cache.add(s,t)}return t}loadBuffer(s){const t=this.json.buffers[s],e=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&s===0)return Promise.resolve(this.extensions[x.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(o,r){e.load(Se.resolveURL(t.uri,n.path),o,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(s){const t=this.json.bufferViews[s];return this.getDependency("buffer",t.buffer).then(function(e){const n=t.byteLength||0,o=t.byteOffset||0;return e.slice(o,o+n)})}loadAccessor(s){const t=this,e=this.json,n=this.json.accessors[s];if(n.bufferView===void 0&&n.sparse===void 0){const r=we[n.type],a=ne[n.componentType],i=n.normalized===!0,l=new a(n.count*r);return Promise.resolve(new pe(l,r,i))}const o=[];return n.bufferView!==void 0?o.push(this.getDependency("bufferView",n.bufferView)):o.push(null),n.sparse!==void 0&&(o.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(o).then(function(r){const a=r[0],i=we[n.type],l=ne[n.componentType],f=l.BYTES_PER_ELEMENT,c=f*i,d=n.byteOffset||0,p=n.bufferView!==void 0?e.bufferViews[n.bufferView].byteStride:void 0,A=n.normalized===!0;let b,T;if(p&&p!==c){const m=Math.floor(d/p),w="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+m+":"+n.count;let R=t.cache.get(w);R||(b=new l(a,m*p,n.count*p/f),R=new kt(b,p/f),t.cache.add(w,R)),T=new on(R,i,d%p/f,A)}else a===null?b=new l(n.count*i):b=new l(a,d,n.count*i),T=new pe(b,i,A);if(n.sparse!==void 0){const m=we.SCALAR,w=ne[n.sparse.indices.componentType],R=n.sparse.indices.byteOffset||0,E=n.sparse.values.byteOffset||0,g=new w(r[1],R,n.sparse.count*m),L=new l(r[2],E,n.sparse.count*i);a!==null&&(T=new pe(T.array.slice(),T.itemSize,T.normalized));for(let S=0,N=g.length;S<N;S++){const M=g[S];if(T.setX(M,L[S*i]),i>=2&&T.setY(M,L[S*i+1]),i>=3&&T.setZ(M,L[S*i+2]),i>=4&&T.setW(M,L[S*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return T})}loadTexture(s){const t=this.json,e=this.options,o=t.textures[s].source,r=t.images[o];let a=this.textureLoader;if(r.uri){const i=e.manager.getHandler(r.uri);i!==null&&(a=i)}return this.loadTextureImage(s,o,a)}loadTextureImage(s,t,e){const n=this,o=this.json,r=o.textures[s],a=o.images[t],i=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[i])return this.textureCache[i];const l=this.loadImageSource(t,e).then(function(f){f.flipY=!1,f.name=r.name||a.name||"";const d=(o.samplers||{})[r.sampler]||{};return f.magFilter=et[d.magFilter]||lt,f.minFilter=et[d.minFilter]||ut,f.wrapS=tt[d.wrapS]||Ne,f.wrapT=tt[d.wrapT]||Ne,n.associations.set(f,{textures:s}),f}).catch(function(){return null});return this.textureCache[i]=l,l}loadImageSource(s,t){const e=this,n=this.json,o=this.options;if(this.sourceCache[s]!==void 0)return this.sourceCache[s].then(c=>c.clone());const r=n.images[s],a=self.URL||self.webkitURL;let i=r.uri||"",l=!1;if(r.bufferView!==void 0)i=e.getDependency("bufferView",r.bufferView).then(function(c){l=!0;const d=new Blob([c],{type:r.mimeType});return i=a.createObjectURL(d),i});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+s+" is missing URI and bufferView");const f=Promise.resolve(i).then(function(c){return new Promise(function(d,p){let A=d;t.isImageBitmapLoader===!0&&(A=function(b){const T=new Ve(b);T.needsUpdate=!0,d(T)}),t.load(Se.resolveURL(c,o.path),A,void 0,p)})}).then(function(c){return l===!0&&a.revokeObjectURL(i),c.userData.mimeType=r.mimeType||ss(r.uri),c}).catch(function(c){throw console.error("THREE.GLTFLoader: Couldn't load texture",i),c});return this.sourceCache[s]=f,f}assignTexture(s,t,e,n){const o=this;return this.getDependency("texture",e.index).then(function(r){if(!r)return null;if(e.texCoord!==void 0&&e.texCoord!=0&&!(t==="aoMap"&&e.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+e.texCoord+" for texture "+t+" not yet supported."),o.extensions[x.KHR_TEXTURE_TRANSFORM]){const a=e.extensions!==void 0?e.extensions[x.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const i=o.associations.get(r);r=o.extensions[x.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),o.associations.set(r,i)}}return n!==void 0&&(r.encoding=n),s[t]=r,r})}assignFinalMaterial(s){const t=s.geometry;let e=s.material;const n=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(s.isPoints){const a="PointsMaterial:"+e.uuid;let i=this.cache.get(a);i||(i=new Ut,ye.prototype.copy.call(i,e),i.color.copy(e.color),i.map=e.map,i.sizeAttenuation=!1,this.cache.add(a,i)),e=i}else if(s.isLine){const a="LineBasicMaterial:"+e.uuid;let i=this.cache.get(a);i||(i=new Bt,ye.prototype.copy.call(i,e),i.color.copy(e.color),this.cache.add(a,i)),e=i}if(n||o||r){let a="ClonedMaterial:"+e.uuid+":";n&&(a+="derivative-tangents:"),o&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let i=this.cache.get(a);i||(i=e.clone(),o&&(i.vertexColors=!0),r&&(i.flatShading=!0),n&&(i.normalScale&&(i.normalScale.y*=-1),i.clearcoatNormalScale&&(i.clearcoatNormalScale.y*=-1)),this.cache.add(a,i),this.associations.set(i,this.associations.get(e))),e=i}e.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),s.material=e}getMaterialType(){return ft}loadMaterial(s){const t=this,e=this.json,n=this.extensions,o=e.materials[s];let r;const a={},i=o.extensions||{},l=[];if(i[x.KHR_MATERIALS_UNLIT]){const c=n[x.KHR_MATERIALS_UNLIT];r=c.getMaterialType(),l.push(c.extendParams(a,o,t))}else{const c=o.pbrMetallicRoughness||{};if(a.color=new Z(1,1,1),a.opacity=1,Array.isArray(c.baseColorFactor)){const d=c.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}c.baseColorTexture!==void 0&&l.push(t.assignTexture(a,"map",c.baseColorTexture,ae)),a.metalness=c.metallicFactor!==void 0?c.metallicFactor:1,a.roughness=c.roughnessFactor!==void 0?c.roughnessFactor:1,c.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(a,"metalnessMap",c.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",c.metallicRoughnessTexture))),r=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(s)}),l.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(s,a)})))}o.doubleSided===!0&&(a.side=dt);const f=o.alphaMode||Le.OPAQUE;if(f===Le.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,f===Le.MASK&&(a.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&r!==ie&&(l.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new v(1,1),o.normalTexture.scale!==void 0)){const c=o.normalTexture.scale;a.normalScale.set(c,c)}return o.occlusionTexture!==void 0&&r!==ie&&(l.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&r!==ie&&(a.emissive=new Z().fromArray(o.emissiveFactor)),o.emissiveTexture!==void 0&&r!==ie&&l.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture,ae)),Promise.all(l).then(function(){const c=new r(a);return o.name&&(c.name=o.name),q(c,o),t.associations.set(c,{materials:s}),o.extensions&&re(n,c,o),c})}createUniqueName(s){const t=Gt.sanitizeNodeName(s||"");let e=t;for(let n=1;this.nodeNamesUsed[e];++n)e=t+"_"+n;return this.nodeNamesUsed[e]=!0,e}loadGeometries(s){const t=this,e=this.extensions,n=this.primitiveCache;function o(a){return e[x.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(i){return st(i,a,t)})}const r=[];for(let a=0,i=s.length;a<i;a++){const l=s[a],f=ns(l),c=n[f];if(c)r.push(c.promise);else{let d;l.extensions&&l.extensions[x.KHR_DRACO_MESH_COMPRESSION]?d=o(l):d=st(new ot,l,t),n[f]={primitive:l,promise:d},r.push(d)}}return Promise.all(r)}loadMesh(s){const t=this,e=this.json,n=this.extensions,o=e.meshes[s],r=o.primitives,a=[];for(let i=0,l=r.length;i<l;i++){const f=r[i].material===void 0?$n(this.cache):this.getDependency("material",r[i].material);a.push(f)}return a.push(t.loadGeometries(r)),Promise.all(a).then(function(i){const l=i.slice(0,i.length-1),f=i[i.length-1],c=[];for(let p=0,A=f.length;p<A;p++){const b=f[p],T=r[p];let m;const w=l[p];if(T.mode===K.TRIANGLES||T.mode===K.TRIANGLE_STRIP||T.mode===K.TRIANGLE_FAN||T.mode===void 0)m=o.isSkinnedMesh===!0?new vt(b,w):new ht(b,w),m.isSkinnedMesh===!0&&!m.geometry.attributes.skinWeight.normalized&&m.normalizeSkinWeights(),T.mode===K.TRIANGLE_STRIP?m.geometry=Qe(m.geometry,rt):T.mode===K.TRIANGLE_FAN&&(m.geometry=Qe(m.geometry,Me));else if(T.mode===K.LINES)m=new jt(b,w);else if(T.mode===K.LINE_STRIP)m=new Kt(b,w);else if(T.mode===K.LINE_LOOP)m=new zt(b,w);else if(T.mode===K.POINTS)m=new Xt(b,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);Object.keys(m.geometry.morphAttributes).length>0&&ts(m,o),m.name=t.createUniqueName(o.name||"mesh_"+s),q(m,o),T.extensions&&re(n,m,T),t.assignFinalMaterial(m),c.push(m)}for(let p=0,A=c.length;p<A;p++)t.associations.set(c[p],{meshes:s,primitives:p});if(c.length===1)return c[0];const d=new be;t.associations.set(d,{meshes:s});for(let p=0,A=c.length;p<A;p++)d.add(c[p]);return d})}loadCamera(s){let t;const e=this.json.cameras[s],n=e[e.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return e.type==="perspective"?t=new pt(Vt.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):e.type==="orthographic"&&(t=new Yt(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),e.name&&(t.name=this.createUniqueName(e.name)),q(t,e),Promise.resolve(t)}loadSkin(s){const t=this.json.skins[s],e=[];for(let n=0,o=t.joints.length;n<o;n++)e.push(this.getDependency("node",t.joints[n]));return t.inverseBindMatrices!==void 0?e.push(this.getDependency("accessor",t.inverseBindMatrices)):e.push(null),Promise.all(e).then(function(n){const o=n.pop(),r=n,a=[],i=[];for(let l=0,f=r.length;l<f;l++){const c=r[l];if(c){a.push(c);const d=new ce;o!==null&&d.fromArray(o.array,l*16),i.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Wt(a,i)})}loadAnimation(s){const e=this.json.animations[s],n=[],o=[],r=[],a=[],i=[];for(let l=0,f=e.channels.length;l<f;l++){const c=e.channels[l],d=e.samplers[c.sampler],p=c.target,A=p.node,b=e.parameters!==void 0?e.parameters[d.input]:d.input,T=e.parameters!==void 0?e.parameters[d.output]:d.output;n.push(this.getDependency("node",A)),o.push(this.getDependency("accessor",b)),r.push(this.getDependency("accessor",T)),a.push(d),i.push(p)}return Promise.all([Promise.all(n),Promise.all(o),Promise.all(r),Promise.all(a),Promise.all(i)]).then(function(l){const f=l[0],c=l[1],d=l[2],p=l[3],A=l[4],b=[];for(let m=0,w=f.length;m<w;m++){const R=f[m],E=c[m],g=d[m],L=p[m],S=A[m];if(R===void 0)continue;R.updateMatrix();let N;switch(W[S.path]){case W.weights:N=an;break;case W.rotation:N=Ye;break;case W.position:case W.scale:default:N=rn;break}const M=R.name?R.name:R.uuid,O=L.interpolation!==void 0?Qn[L.interpolation]:mt,I=[];W[S.path]===W.weights?R.traverse(function(P){P.morphTargetInfluences&&I.push(P.name?P.name:P.uuid)}):I.push(M);let _=g.array;if(g.normalized){const P=Pe(_.constructor),j=new Float32Array(_.length);for(let k=0,F=_.length;k<F;k++)j[k]=_[k]*P;_=j}for(let P=0,j=I.length;P<j;P++){const k=new N(I[P]+"."+W[S.path],E.array,_,O);L.interpolation==="CUBICSPLINE"&&(k.createInterpolant=function(U){const B=this instanceof Ye?Jn:Et;return new B(this.times,this.values,this.getValueSize()/3,U)},k.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),b.push(k)}}const T=e.name?e.name:"animation_"+s;return new qt(T,void 0,b)})}createNodeMesh(s){const t=this.json,e=this,n=t.nodes[s];return n.mesh===void 0?null:e.getDependency("mesh",n.mesh).then(function(o){const r=e._getNodeRef(e.meshCache,n.mesh,o);return n.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let i=0,l=n.weights.length;i<l;i++)a.morphTargetInfluences[i]=n.weights[i]}),r})}loadNode(s){const t=this.json,e=this.extensions,n=this,o=t.nodes[s],r=o.name?n.createUniqueName(o.name):"";return function(){const a=[],i=n._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(s)});i&&a.push(i),o.camera!==void 0&&a.push(n.getDependency("camera",o.camera).then(function(d){return n._getNodeRef(n.cameraCache,o.camera,d)})),n._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(s)}).forEach(function(d){a.push(d)});const l=[],f=o.children||[];for(let d=0,p=f.length;d<p;d++)l.push(n.getDependency("node",f[d]));const c=o.skin===void 0?Promise.resolve(null):n.getDependency("skin",o.skin);return Promise.all([Promise.all(a),Promise.all(l),c])}().then(function(a){const i=a[0],l=a[1],f=a[2];let c;if(o.isBone===!0?c=new Zt:i.length>1?c=new be:i.length===1?c=i[0]:c=new ct,c!==i[0])for(let d=0,p=i.length;d<p;d++)c.add(i[d]);if(o.name&&(c.userData.name=o.name,c.name=r),q(c,o),o.extensions&&re(e,c,o),o.matrix!==void 0){const d=new ce;d.fromArray(o.matrix),c.applyMatrix4(d)}else o.translation!==void 0&&c.position.fromArray(o.translation),o.rotation!==void 0&&c.quaternion.fromArray(o.rotation),o.scale!==void 0&&c.scale.fromArray(o.scale);n.associations.has(c)||n.associations.set(c,{}),n.associations.get(c).nodes=s,f!==null&&c.traverse(function(d){d.isSkinnedMesh&&d.bind(f,os)});for(let d=0,p=l.length;d<p;d++)c.add(l[d]);return c})}loadScene(s){const t=this.extensions,e=this.json.scenes[s],n=this,o=new be;e.name&&(o.name=n.createUniqueName(e.name)),q(o,e),e.extensions&&re(t,o,e);const r=e.nodes||[],a=[];for(let i=0,l=r.length;i<l;i++)a.push(n.getDependency("node",r[i]));return Promise.all(a).then(function(i){for(let f=0,c=i.length;f<c;f++)o.add(i[f]);const l=f=>{const c=new Map;for(const[d,p]of n.associations)(d instanceof ye||d instanceof Ve)&&c.set(d,p);return f.traverse(d=>{const p=n.associations.get(d);p!=null&&c.set(d,p)}),c};return n.associations=l(o),o})}}function is(h,s,t){const e=s.attributes,n=new cn;if(e.POSITION!==void 0){const a=t.json.accessors[e.POSITION],i=a.min,l=a.max;if(i!==void 0&&l!==void 0){if(n.set(new G(i[0],i[1],i[2]),new G(l[0],l[1],l[2])),a.normalized){const f=Pe(ne[a.componentType]);n.min.multiplyScalar(f),n.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=s.targets;if(o!==void 0){const a=new G,i=new G;for(let l=0,f=o.length;l<f;l++){const c=o[l];if(c.POSITION!==void 0){const d=t.json.accessors[c.POSITION],p=d.min,A=d.max;if(p!==void 0&&A!==void 0){if(i.setX(Math.max(Math.abs(p[0]),Math.abs(A[0]))),i.setY(Math.max(Math.abs(p[1]),Math.abs(A[1]))),i.setZ(Math.max(Math.abs(p[2]),Math.abs(A[2]))),d.normalized){const b=Pe(ne[d.componentType]);i.multiplyScalar(b)}a.max(i)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(a)}h.boundingBox=n;const r=new ln;n.getCenter(r.center),r.radius=n.min.distanceTo(n.max)/2,h.boundingSphere=r}function st(h,s,t){const e=s.attributes,n=[];function o(r,a){return t.getDependency("accessor",r).then(function(i){h.setAttribute(a,i)})}for(const r in e){const a=Ie[r]||r.toLowerCase();a in h.attributes||n.push(o(e[r],a))}if(s.indices!==void 0&&!h.index){const r=t.getDependency("accessor",s.indices).then(function(a){h.setIndex(a)});n.push(r)}return q(h,s),is(h,s,t),Promise.all(n).then(function(){return s.targets!==void 0?es(h,s.targets,t):h})}const as=()=>{let h,s,t,e,n,o,r;const c=T(128,128),d=new An;p(),w();function p(){h=document.querySelector("#map"),e=new pt(60,window.innerWidth/window.innerHeight,1,2e4),e.position.set(100,100,100),o=new fn,o.background=new Z(12571109),s=new dn(500),o.add(s);const E=new ce,g=new se(100,100);g.attributes.uv.array[1]=.5,g.attributes.uv.array[3]=.5,g.rotateY(Math.PI/2),g.translate(50,0,0);const L=new se(100,100);L.attributes.uv.array[1]=.5,L.attributes.uv.array[3]=.5,L.rotateY(-Math.PI/2),L.translate(-50,0,0);const S=new se(100,100);S.attributes.uv.array[5]=.5,S.attributes.uv.array[7]=.5,S.rotateX(-Math.PI/2),S.translate(0,50,0);const N=new se(100,100);N.attributes.uv.array[1]=.5,N.attributes.uv.array[3]=.5,N.translate(0,0,50);const M=new se(100,100);M.attributes.uv.array[1]=.5,M.attributes.uv.array[3]=.5,M.rotateY(Math.PI),M.translate(0,0,-50);const O=[];for(let F=0;F<128;F++)for(let U=0;U<128;U++){const B=m(U,F);E.makeTranslation(U*100-64*100,B*100,F*100-64*100);const le=m(U+1,F),ue=m(U-1,F),fe=m(U,F+1),de=m(U,F-1);O.push(S.clone().applyMatrix4(E)),(le!==B&&le!==B+1||U===0)&&O.push(g.clone().applyMatrix4(E)),(ue!==B&&ue!==B+1||U===128-1)&&O.push(L.clone().applyMatrix4(E)),(fe!==B&&fe!==B+1||F===128-1)&&O.push(N.clone().applyMatrix4(E)),(de!==B&&de!==B+1||F===0)&&O.push(M.clone().applyMatrix4(E))}const I=In(O);I.computeBoundingSphere();const _=new URL("data:image/png;base64,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",self.location).href,P=new me().load(_);P.magFilter=gt,new ht(I,new hn({map:P,side:dt}));const j=new pn(4210752);o.add(j);const k=new at(16777215,2);k.position.set(1,1,.5).normalize(),o.add(k),A(),r=new mn({antialias:!0}),r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),h.appendChild(r.domElement),n=new Nn(e,r.domElement),window.addEventListener("resize",b)}function A(){const E=new Pn,g=new URL(""+new URL("Material_0_baseColor-aadc60f7.png",import.meta.url).href,self.location).href;new URL(""+new URL("CoC_iOS_HER_PPA_SEN_Bmat_baseColor-3d1bfea7.png",import.meta.url).href,self.location).href;const L=new URL(""+new URL("Material_0_normal-c1413ccf.png",import.meta.url).href,self.location).href,S=new me().load(g),N=new me().load(L);E.load("/dinosaur/scene.gltf",M=>{M.scene.scale.set(10,10,10),m(100,300),M.scene.position.set(0,0,0),M.scene.traverse(function(I){I.isMesh&&(I.material.emissive=I.material.color,I.material.emissiveMap=I.material.map),I.type==="Mesh"&&(I.material=new gn({color:13421772,map:S,normalMap:N,normalScale:new v(3,3)}))}),o.add(M.scene),t=new Tn(M.scene),console.log("first-mixer: ",t);const O=M.animations[4];console.log(O,"clip"),t.clipAction(O).setDuration(.05).play()})}function b(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight)}function T(E,g){const L=[],S=new Sn,N=E*g,M=Math.random()*100;let O=2;for(let I=0;I<4;I++){if(I===0)for(let _=0;_<N;_++)L[_]=0;for(let _=0;_<N;_++){const P=_%E,j=_/E|0;L[_]+=S.noise(P/O,j/O,M)*O}O*=4}return L}function m(E,g){return c[E+g*128]*.15|0}function w(){requestAnimationFrame(w),R()}function R(){n.update(d.getDelta()),t==null||t.update(d.getDelta()),r.render(o,e)}},cs={class:"island"},ls=Tt("div",{id:"map"},null,-1),hs=bn({__name:"Model",setup(h){Rn(()=>as());const s=xn(!1),t=async()=>{s.value=!0,await En()};return(e,n)=>(We(),wn("div",cs,[Tt("div",{class:"position-a",onClick:n[0]||(n[0]=()=>t())},""),s.value?(We(),Ln(yn,{key:0})):Mn("",!0),ls]))}});export{hs as default};
