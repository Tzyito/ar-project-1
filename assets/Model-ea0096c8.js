import{E as b,V as E,a as _,Q as O,S as y,P as M,b as x,A as R,c as C,d as A,M as D,e as T,W as j,C as L}from"./three.module-12fc4397.js";import{u as P}from"./useCamera-b2727555.js";import{d as q,g as W,o as k,c as z,h as H}from"./index-0d809925.js";function v(c){const n=this;this.object=c,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation=null,this.screenOrientation=0,this.alphaOffset=0,this.initialOffset=null;const o=function({alpha:e,beta:i,gamma:s}){n.initialOffset===null&&(n.initialOffset=e),console.log(e,"alpha值"),e=e-n.initialOffset,e<0&&(e+=360),n.deviceOrientation={alpha:e,beta:i,gamma:s}},t=function(){n.screenOrientation=window.orientation||0},d=function(){window.addEventListener("orientationchange",t,!1),window.addEventListener("deviceorientation",o,!1)}.bind(this),h=function(){const e=new E(0,0,1),i=new _,s=new O,u=new O(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(a,f,l,w,m){i.set(l,f,-w,"YXZ"),a.setFromEuler(i),a.multiply(u),a.multiply(s.setFromAxisAngle(e,-m))}}();this.connect=function(){t(),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent.requestPermission().then(function(e){e=="granted"&&(console.log("点击确认"),d())}).catch(function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)}):d(),n.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",t,!1),window.removeEventListener("deviceorientation",o,!1),n.enabled=!1,n.deviceOrientation=null,n.initialOffset=null},this.update=function({theta:e=0}={theta:0}){if(n.enabled===!1)return;const i=n.deviceOrientation;if(i){const s=i.alpha?(void 0).degToRad(i.alpha)+n.alphaOffset:0,u=i.beta?(void 0).degToRad(i.beta):0,a=i.gamma?(void 0).degToRad(i.gamma):0,f=n.screenOrientation?(void 0).degToRad(n.screenOrientation):0;h(n.object.quaternion,s+e,u,a,f)}},this.dispose=function(){n.disconnect()},this.getAlpha=function(){const{deviceOrientation:e}=n;return e&&e.alpha?(void 0).degToRad(e.alpha)+n.alphaOffset:0},this.getBeta=function(){const{deviceOrientation:e}=n;return e&&e.beta?(void 0).degToRad(e.beta):0}}v.prototype=Object.assign(Object.create(b.prototype),{constructor:v});const S=async()=>{let c;const n=new L,o=new y,t=new M(75,window.innerWidth/window.innerHeight,.1,1e3);t.position.set(100,100,100);const d=document.querySelector("#box"),h=await w(),e=new x(h);o.background=e;const i=new R(5e3);o.add(i);const s=new C(4210752);o.add(s);const u=new A(108,71),a=new D({color:"red"}),f=new T(u,a);o.add(f);const l=new j;l.setSize(window.innerWidth,window.innerHeight),d==null||d.appendChild(l.domElement),c=new v(t),window.addEventListener("resize",m);async function w(){const r=document.createElement("video");return r.srcObject=await P(!0),r.autoplay=!0,r}function m(){t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),l.setSize(window.innerWidth,window.innerHeight)}function g(){requestAnimationFrame(g),c.update(n.getDelta());const{beta:r=null,gamma:p=null}=c.deviceOrientation??{};console.log(r,p,"位置"),!(!r||!p)&&(t.lookAt(0,0,0),t.position.x=-p/90,t.position.y=r/90,t.position.z=1-.5*Math.min(Math.abs(t.position.x)+Math.abs(t.position.y),1),l.render(o,t))}g()},B={id:"container"},V=H("div",{id:"box"},null,-1),F=[V],Y=q({__name:"Model",setup(c){return W(()=>{S()}),(n,o)=>(k(),z("div",B,F))}});export{Y as default};
